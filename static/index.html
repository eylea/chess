<!DOCTYPE html>
<html lang="en">

<head>
    <!-- <script src="index.js"></script> -->
    <style>
        table {
            margin: 0 auto;
            border-collapse: collapse;
            width: 80vh;
            height: 80vh;
        }

        td {
            width: 10vh;
            height: 10vh;
            text-align: center;
            /* Horizontal centering */
            vertical-align: middle;
            /* Vertical centering */
            font-size: 6vh;
            /* Adjust font size as needed */
            border: 1px solid black;
            /* Add a border to the cells */
        }

        .piece {
            cursor: pointer;
            width: 80%;
            height: 80%;
        }

        .white {
            background-color: #f0d9b5;
        }

        .black {
            background-color: #b58863;
        }

        .no-select {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
    </style>
</head>


<!-- <body> -->
<!--     <h1>Chess Game</h1> -->
<!--     <button id="getGameButton"> -->
<!--         Get Game -->
<!--     </button> -->
<!--     <canvas id="chessBoard"></canvas> -->
<!--     <script> -->
<!--         getGameButton = document.getElementById('getGameButton'); -->
<!--         getGameButton.addEventListener('click', handleGetGame); -->
<!--     </script> -->
<!-- </body> -->

<body>
    <script src="chess.js"></script>
    <div id="container"></div>
    <button id="get-game-button">Get Game</button>
    <button id="reset-button">Reset Position</button>
    <script>
        const handleGetGame = () => {
            fetch('http://localhost:8080/game')
                .then(response => response.json())
                .then(data => {
                    const container = document.getElementById('container');
                    const ws = new WebSocket('ws://localhost:8080/game/' + data.game_id);
                    ws.onopen = () => {
                        console.log('Connected to server');
                    };

                    ws.onmessage = (message) => {
                        // Only create the ChessBoard instance once upon receiving the first message
                        if (!container.chessBoard) {
                            container.chessBoard = new ChessBoard(container, makeHandleOnMove(ws));
                        }
                        handleOnMessage(container.chessBoard)(message);
                    };
                });
        };

        const button = document.getElementById('get-game-button');
        button.addEventListener('click', handleGetGame);

    </script>


</body>

</html>
